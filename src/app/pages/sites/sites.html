<div class="card p-4 gap-4">
    <!-- Action Buttons -->
    <!-- Action Buttons -->
    <div class="flex flex-wrap justify-end gap-2">
        <p-button label="Add Restaurant" icon="pi pi-plus" (click)="showAddRestaurantDialog()"> </p-button>
    </div>

    <!-- Add Restaurant Dialog -->
    <p-dialog header="Add Restaurant" [(visible)]="displayAddDialog" [modal]="true" [style]="{width: '50vw'}" [closable]="true">
        <form [formGroup]="addRestaurantForm" (ngSubmit)="submitRestaurant()">
            <!-- Name -->
            <div class="mb-3">
                <label class="font-semibold mb-3" for="name">Name</label>
                <input type="text" id="name" pInputText formControlName="name" class="w-full" />
            </div>

            <!-- Cuisine -->
            <div class="mb-3">
                <label class="font-semibold">Cuisine</label>
                <input type="text" pInputText formControlName="cuisine" class="w-full" />
            </div>

            <!-- Description -->
            <div class="mb-3">
                <label class="font-semibold">Description</label>
                <textarea pInputTextarea formControlName="description" class="w-full"></textarea>
            </div>
            <!-- rate -->
            <div class="mb-3">
                <label class="font-semibold">Rate</label>
                <p-inputnumber  pInputTextarea formControlName="rate" mode="decimal" [min]="0" [max]="5" class="w-full"/>
            </div>

            <!-- Phone -->
            <div class="mb-3">
                <label class="font-semibold">Phone</label>
                <input type="text" pInputText formControlName="phone" class="w-full" />
            </div>

            <!-- Website Link -->
            <div class="mb-3">
                <label class="font-semibold">Website Link</label>
                <input type="text" pInputText formControlName="websiteLink" class="w-full" />
            </div>

            <!-- Delivery Time -->
            <div class="mb-3">
                <label class="font-semibold">Delivery Time</label>
                <input type="text" pInputText formControlName="deliveryTime" class="w-full" />
            </div>

            <!-- Distance -->
            <div class="mb-3">
                <label class="font-semibold">Distance</label>
                <input type="text" pInputText formControlName="distance" class="w-full" />
            </div>

            <!-- Main Image -->
            <div class="mb-3">
                <label class="font-semibold">Main Image</label>
                <p-fileUpload
                    name="mainImage"
                    [multiple]="false"
                    accept="image/*"
                    [auto]="true"
                    [showUploadButton]="false"
                    [showCancelButton]="false"
                    (onSelect)="onMainImageSelected($event)"
                    (onRemove)="onMainImageRemoved($event)"
                >
                </p-fileUpload>
               
            </div>

            <!-- Menu Images -->
            <div class="mb-3">
                <label class="font-semibold">Menu Images</label>
                <p-fileUpload
                    name="menuImages"
                    [multiple]="true"
                    accept="image/*"
                    [auto]="false"
                    [showUploadButton]="false"
                    [showCancelButton]="false"
                    (onSelect)="onMenuImagesSelected($event)"
                    (onRemove)="onMenuImageRemoved($event)"
                >
                </p-fileUpload>
            </div>

            <!-- Actions -->
            <div class="flex justify-end gap-2 mt-4">
                <p-button label="Cancel" icon="pi pi-times" class="p-button-text" (click)="displayAddDialog=false"></p-button>
                <p-button type="submit" label="Save" icon="pi pi-check" [disabled]="addRestaurantForm.invalid"></p-button>
            </div>
        </form>
    </p-dialog>

    <!-- Table -->
    <p-table [value]="restaurants" [paginator]="true" [rows]="5" responsiveLayout="stack" [breakpoint]="'768px'" class="w-full mt-4">
        <ng-template pTemplate="header">
            <tr class="bg-gray-100">
                <th class="p-3 text-left">Name</th>
                <th class="p-3 text-left">Cuisine</th>
                <th class="p-3 text-left">Description</th>
                <th class="p-3 text-left">Rating</th>
                <th class="p-3 text-left">Phone</th>
                <th class="p-3 text-left">Link</th>
                <th class="p-3 text-left">Delivery Time</th>
                <th class="p-3 text-left">Distance</th>
                <th class="p-3 text-left">Image</th>
                <th class="p-3 text-left">Menu</th>
                <th class="p-3 text-left">Status</th>
                <th class="p-3 text-left">product</th>
                <th class="p-3 text-left">Actions</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-restaurant let-rowIndex="rowIndex">
            <tr class="border-b hover:bg-gray-50 md:table-row block md:border-none">
                <!-- Name -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Name">
                    <span class="md:hidden font-semibold text-gray-700">Name:</span>
                    {{ restaurant.name }}
                </td>

                <!-- Cuisine -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Cuisine">
                    <span class="md:hidden font-semibold text-gray-700">Cuisine:</span>
                    {{ restaurant.cuisine }}
                </td>

                <!-- Discripion -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Cuisine">
                    <span class="md:hidden font-semibold text-gray-700">Description:</span>
                    {{ restaurant.discripion }}
                </td>

                <!-- Rating -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Rating">
                    <span class="md:hidden font-semibold text-gray-700">Rating:</span>
                    {{ restaurant.rating }} / 5
                </td>

                <!-- Phone -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Phone">
                    <span class="md:hidden font-semibold text-gray-700">Phone:</span>
                    {{ restaurant.phone }}
                </td>
                <!-- Phone -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Phone">
                    <span class="md:hidden font-semibold text-gray-700">Link:</span>
                    <p-button icon="pi pi-image" [rounded]="true" (click)="navigateLink(restaurant.websiteLink)"> </p-button>
                </td>

                <!-- Delivery Time -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Delivery Time">
                    <span class="md:hidden font-semibold text-gray-700">Delivery Time:</span>
                    {{ restaurant.deliveryTime }}
                </td>

                <!-- Distance -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Distance">
                    <span class="md:hidden font-semibold text-gray-700">Distance:</span>
                    {{ restaurant.distance }}
                </td>

                <!-- Images -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Images">
                    <span class="md:hidden font-semibold text-gray-700">Images:</span>
                    <p-button icon="pi pi-image" [rounded]="true" (click)="showImages(restaurant.image)"> </p-button>
                </td>

                <!-- Menu -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Menu">
                    <span class="md:hidden font-semibold text-gray-700">Menu:</span>
                    <p-button icon="pi pi-book" [rounded]="true" (click)="showImages(restaurant.menu)"> </p-button>
                </td>

                <!-- Status -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Status">
                    <span class="md:hidden font-semibold text-gray-700">Status:</span>
                    <span [class]="restaurant.isOpen ? 'text-green-600 font-semibold' : 'text-red-600 font-semibold'"> {{ restaurant.isOpen ? 'Open' : 'Closed' }} </span>
                </td>

                <!-- Product -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Product">
                    <span class="md:hidden font-semibold text-gray-700">Prodcut:</span>
                    <p-button icon="pi pi-box" [rounded]="true" (click)="routeToProduct(restaurant.id)"> </p-button>
                </td>

                <!-- Actions -->
                <td class="p-3 flex justify-between md:table-cell" data-label="Actions">
                    <span class="md:hidden font-semibold text-gray-700">Actions:</span>
                    <div class="flex gap-1 mt-2">
                        <p-button icon="pi pi-pencil" [rounded]="true" severity="info"></p-button>
                        <p-button icon="pi pi-trash" [rounded]="true" severity="danger"></p-button>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>

<!-- Images Dialog -->
<p-dialog header="Restaurant Images" [(visible)]="displayImagesDialog" [modal]="true" [style]="{width: '60vw'}" [closable]="true">
    <div class="flex flex-wrap gap-4">
        @for (img of selectedRestaurantImages; track img) {
        <img [src]="img.url" alt="Restaurant Image" class="w-40 h-40 object-cover rounded shadow" (click)="previewImage(img.url)" />
        }
    </div>
</p-dialog>

<!-- Single Image Dialog -->
<p-dialog header="Image Preview" [(visible)]="displayImageDialog" [modal]="true" [style]="{width: '50vw'}" [closable]="true">
    <img [src]="selectedImageUrl" alt="Selected" class="w-full h-auto rounded shadow" />
</p-dialog>
